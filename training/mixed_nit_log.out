


AQA: TRAINING gemma-2b WITH mixed context!


wandb: Currently logged in as: danschumac1 (danschumac1-nlp). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.5
wandb: Run data is saved locally in /home/dan/mini_temporal/wandb/run-20240603_163728-lxx4kou0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glorious-wildflower-204
wandb: ‚≠êÔ∏è View project at https://wandb.ai/danschumac1-nlp/temporal_understanding
wandb: üöÄ View run at https://wandb.ai/danschumac1-nlp/temporal_understanding/runs/lxx4kou0/workspace
`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
WANDB
LOG INTO HUGGING FACE
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /home/dan/.cache/huggingface/token
Login successful
load model
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:01<00:01,  1.35s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:01<00:00,  1.60it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:01<00:00,  1.36it/s]
tokenizer
load data
Data loaded
Preprocessing dataset with context: mixed_context
Using prompt column: mixed_prompt
First 5 entries of df[mixed_prompt]:
0    <bos>In June 2004,who made its first increase ...
1    <bos>What was the name of the lead singer of Q...
2    <bos>Russia attacked the capital city of what ...
3    <bos>In July 2003 which Labour M.P. was heavil...
4    <bos>Where was Spielberg honored on Dec 3, 200...
Name: mixed_prompt, dtype: object
Map:   0%|          | 0/350 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 350/350 [00:00<00:00, 11510.16 examples/s]
Dataset after tokenization:
{'i': 331, 'idx': 'TQ_exp_177', 'question': 'What 1991 musical was based on the novel by Frances Hodgson Burnett?', 'answer': 'The Secret Garden', 'relevant_context': 'The Secret Garden is indeed a musical based on the 1911 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1991. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical.', 'source': 'TQ_explicet_explicet', 'type': 'train', 'random_context': 'Felipe Calder√≥n became President of Mexico on December 1, 2006. He served as the President of Mexico from 2006 to 2012, representing the National Action Party (Partido Acci√≥n Nacional, PAN). His presidency was marked by a strong focus on economic reforms and a controversial military-led approach to tackling drug cartels and organized crime, which resulted in an escalation of violence in some regions of the country.', 'wrong_date_context': 'The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical.', 'no_prompt': '<bos>What 1991 musical was based on the novel by Frances Hodgson Burnett? The answer is: The Secret Garden<eos>', 'rel_prompt': '<bos>What 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 1911 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1991. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical. The answer is: The Secret Garden<eos>', 'rand_prompt': '<bos>What 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: Felipe Calder√≥n became President of Mexico on December 1, 2006. He served as the President of Mexico from 2006 to 2012, representing the National Action Party (Partido Acci√≥n Nacional, PAN). His presidency was marked by a strong focus on economic reforms and a controversial military-led approach to tackling drug cartels and organized crime, which resulted in an escalation of violence in some regions of the country. The answer is: The Secret Garden<eos>', 'wd_prompt': '<bos>What 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical. The answer is: The Secret Garden<eos>', 'mixed_prompt': '<bos>What 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical. The answer is: The Secret Garden<eos>', 'input_ids': [2, 1841, 235248, 235274, 235315, 235315, 235274, 13340, 729, 3482, 611, 573, 9705, 731, 24629, 133957, 109141, 235336, 5698, 603, 573, 4807, 235292, 714, 8182, 15034, 603, 10094, 476, 13340, 3482, 611, 573, 235248, 235284, 235276, 235276, 235284, 9705, 576, 573, 1809, 1503, 731, 24629, 133957, 109141, 235265, 3279, 476, 2870, 578, 23658, 731, 187669, 27896, 578, 4296, 731, 36201, 17073, 235269, 573, 13340, 131613, 611, 31707, 575, 235248, 235274, 235315, 235324, 235318, 235265, 1165, 13992, 573, 3904, 576, 7473, 155504, 235269, 476, 3486, 4645, 4602, 7565, 578, 9244, 575, 573, 7149, 17960, 235269, 1064, 603, 220577, 731, 476, 102331, 31942, 1185, 1284, 603, 29754, 1658, 2187, 235265, 2475, 603, 3841, 3024, 774, 5339, 577, 48284, 235269, 6879, 235269, 577, 3685, 675, 22631, 7624, 1284, 919, 2447, 2211, 235265, 3636, 1997, 18347, 72940, 685, 1284, 14042, 888, 1913, 577, 476, 40350, 8717, 235269, 685, 1578, 685, 577, 1070, 186953, 33800, 578, 32011, 235265, 714, 1500, 4956, 9523, 148477, 578, 2792, 3757, 20315, 18478, 235269, 3359, 7354, 6757, 576, 476, 44000, 235265, 714, 3448, 603, 235292, 714, 8182, 15034, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
Error decoding dataset: 0
Preprocessing dataset with context: mixed_context
Using prompt column: mixed_prompt
First 5 entries of df[mixed_prompt]:
0    <bos>Who was named president of Disney-ABC tel...
1    <bos>Which pope dies at his home in the Vatica...
2    <bos>Who announces he will retire from Formula...
3    <bos>Which agreement came into effect between ...
4    <bos>Which "country legend" singer died in Ame...
Name: mixed_prompt, dtype: object
Map:   0%|          | 0/75 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 75/75 [00:00<00:00, 8423.88 examples/s]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ü§ó Transformers. Use `eval_strategy` instead
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a tokenizer with `padding_side` not equal to `right` to the SFTTrainer. This might lead to some unexpected behaviour due to overflow issues when training a model in half-precision. You might consider adding `tokenizer.padding_side = 'right'` to your code.
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Dataset after tokenization:
{'i': 68, 'idx': 'TQ_exp_122', 'question': 'In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"?', 'answer': 'Frank Gorshin', 'relevant_context': 'Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in May 2005. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.', 'source': 'TQ_explicet_explicet', 'type': 'dev', 'random_context': 'The Super Bowl hosted in San Diego in 2003 was actually Super Bowl XXXVII (37), not Super Bowl XXXVIII (38). Super Bowl XXXVII was played on January 26, 2003, at Qualcomm Stadium (now known as SDCCU Stadium), where the Tampa Bay Buccaneers defeated the Oakland Raiders with a score of 48-21.', 'wrong_date_context': 'Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in October 1958. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.', 'no_prompt': '<bos>In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? The answer is: Frank Gorshin<eos>', 'rel_prompt': '<bos>In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in May 2005. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television. The answer is: Frank Gorshin<eos>', 'rand_prompt': '<bos>In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: The Super Bowl hosted in San Diego in 2003 was actually Super Bowl XXXVII (37), not Super Bowl XXXVIII (38). Super Bowl XXXVII was played on January 26, 2003, at Qualcomm Stadium (now known as SDCCU Stadium), where the Tampa Bay Buccaneers defeated the Oakland Raiders with a score of 48-21. The answer is: Frank Gorshin<eos>', 'wd_prompt': '<bos>In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in October 1958. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television. The answer is: Frank Gorshin<eos>', 'mixed_prompt': '<bos>In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? The answer is: Frank Gorshin<eos>', 'input_ids': [2, 886, 2782, 235248, 235284, 235276, 235276, 235308, 235269, 948, 671, 3725, 14250, 7206, 3024, 1064, 729, 3836, 604, 926, 4731, 685, 664, 1175, 17675, 136038, 235281, 575, 15734, 4100, 664, 63719, 27017, 714, 3448, 603, 235292, 7851, 653, 976, 12147, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
Error decoding dataset: 0
Data preprocessed
lora
Trainable: 78446592 | total: 2584619008 | Percentage: 3.0351%
Model prepared for training
Trainer set up
  0%|          | 0/12 [00:00<?, ?it/s]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/bitsandbytes/nn/modules.py:426: UserWarning: Input type into Linear4bit is torch.float16, but bnb_4bit_compute_dtype=torch.float32 (default). This will lead to slow inference or training speed.
  warnings.warn(
  8%|‚ñä         | 1/12 [01:14<13:43, 74.87s/it] 17%|‚ñà‚ñã        | 2/12 [02:24<11:57, 71.76s/it] 25%|‚ñà‚ñà‚ñå       | 3/12 [03:37<10:51, 72.42s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 4/12 [04:51<09:42, 72.80s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 5/12 [06:08<08:41, 74.52s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 6/12 [07:19<07:19, 73.20s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 7/12 [08:31<06:03, 72.78s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 8/12 [09:41<04:47, 71.90s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 9/12 [10:55<03:38, 72.67s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 10/12 [12:04<02:23, 71.62s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 11/12 [13:17<01:11, 71.81s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [14:29<00:00, 71.90s/it]                                               100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [14:29<00:00, 71.90s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [14:29<00:00, 72.43s/it]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'train_runtime': 870.4882, 'train_samples_per_second': 2.412, 'train_steps_per_second': 0.014, 'train_loss': 2.2869903246561685, 'epoch': 4.36}
Model and tokenizer saved at ./training/models/TQE/gemma-2b/mixed_context
wandb: - 299.301 MB of 299.301 MB uploadedwandb: \ 299.301 MB of 299.301 MB uploadedwandb: | 299.301 MB of 299.301 MB uploadedwandb: / 299.334 MB of 299.358 MB uploaded (0.003 MB deduped)wandb: - 299.373 MB of 299.373 MB uploaded (0.003 MB deduped)wandb: 
wandb: Run history:
wandb:       train/epoch ‚ñÅ
wandb: train/global_step ‚ñÅ
wandb: 
wandb: Run summary:
wandb:               total_flos 3521583689465856.0
wandb:              train/epoch 4.36364
wandb:        train/global_step 12
wandb:               train_loss 2.28699
wandb:            train_runtime 870.4882
wandb: train_samples_per_second 2.412
wandb:   train_steps_per_second 0.014
wandb: 
wandb: üöÄ View run glorious-wildflower-204 at: https://wandb.ai/danschumac1-nlp/temporal_understanding/runs/lxx4kou0/workspace
wandb: Synced 6 W&B file(s), 0 media file(s), 6 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240603_163728-lxx4kou0/logs


AQA: TRAINING gemma-7b WITH mixed context!


wandb: Currently logged in as: danschumac1 (danschumac1-nlp). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.5
wandb: Run data is saved locally in /home/dan/mini_temporal/wandb/run-20240603_165219-bjzqy0j2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run charmed-glade-206
wandb: ‚≠êÔ∏è View project at https://wandb.ai/danschumac1-nlp/temporal_understanding
wandb: üöÄ View run at https://wandb.ai/danschumac1-nlp/temporal_understanding/runs/bjzqy0j2/workspace
`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
WANDB
LOG INTO HUGGING FACE
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /home/dan/.cache/huggingface/token
Login successful
load model
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  1.21s/it]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:02<00:02,  1.16s/it]Loading checkpoint shards:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:03<00:01,  1.15s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  1.10it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:04<00:00,  1.00s/it]
tokenizer
load data
Data loaded
Preprocessing dataset with context: mixed_context
Using prompt column: mixed_prompt
First 5 entries of df[mixed_prompt]:
0    <bos>In June 2004,who made its first increase ...
1    <bos>What was the name of the lead singer of Q...
2    <bos>Russia attacked the capital city of what ...
3    <bos>In July 2003 which Labour M.P. was heavil...
4    <bos>Where was Spielberg honored on Dec 3, 200...
Name: mixed_prompt, dtype: object
Map:   0%|          | 0/350 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 350/350 [00:00<00:00, 11489.62 examples/s]
Dataset after tokenization:
{'i': 331, 'idx': 'TQ_exp_177', 'question': 'What 1991 musical was based on the novel by Frances Hodgson Burnett?', 'answer': 'The Secret Garden', 'relevant_context': 'The Secret Garden is indeed a musical based on the 1911 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1991. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical.', 'source': 'TQ_explicet_explicet', 'type': 'train', 'random_context': 'Felipe Calder√≥n became President of Mexico on December 1, 2006. He served as the President of Mexico from 2006 to 2012, representing the National Action Party (Partido Acci√≥n Nacional, PAN). His presidency was marked by a strong focus on economic reforms and a controversial military-led approach to tackling drug cartels and organized crime, which resulted in an escalation of violence in some regions of the country.', 'wrong_date_context': 'The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical.', 'no_prompt': '<bos>What 1991 musical was based on the novel by Frances Hodgson Burnett? The answer is: The Secret Garden<eos>', 'rel_prompt': '<bos>What 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 1911 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1991. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical. The answer is: The Secret Garden<eos>', 'rand_prompt': '<bos>What 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: Felipe Calder√≥n became President of Mexico on December 1, 2006. He served as the President of Mexico from 2006 to 2012, representing the National Action Party (Partido Acci√≥n Nacional, PAN). His presidency was marked by a strong focus on economic reforms and a controversial military-led approach to tackling drug cartels and organized crime, which resulted in an escalation of violence in some regions of the country. The answer is: The Secret Garden<eos>', 'wd_prompt': '<bos>What 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical. The answer is: The Secret Garden<eos>', 'mixed_prompt': '<bos>What 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical. The answer is: The Secret Garden<eos>', 'input_ids': [2, 1841, 235248, 235274, 235315, 235315, 235274, 13340, 729, 3482, 611, 573, 9705, 731, 24629, 133957, 109141, 235336, 5698, 603, 573, 4807, 235292, 714, 8182, 15034, 603, 10094, 476, 13340, 3482, 611, 573, 235248, 235284, 235276, 235276, 235284, 9705, 576, 573, 1809, 1503, 731, 24629, 133957, 109141, 235265, 3279, 476, 2870, 578, 23658, 731, 187669, 27896, 578, 4296, 731, 36201, 17073, 235269, 573, 13340, 131613, 611, 31707, 575, 235248, 235274, 235315, 235324, 235318, 235265, 1165, 13992, 573, 3904, 576, 7473, 155504, 235269, 476, 3486, 4645, 4602, 7565, 578, 9244, 575, 573, 7149, 17960, 235269, 1064, 603, 220577, 731, 476, 102331, 31942, 1185, 1284, 603, 29754, 1658, 2187, 235265, 2475, 603, 3841, 3024, 774, 5339, 577, 48284, 235269, 6879, 235269, 577, 3685, 675, 22631, 7624, 1284, 919, 2447, 2211, 235265, 3636, 1997, 18347, 72940, 685, 1284, 14042, 888, 1913, 577, 476, 40350, 8717, 235269, 685, 1578, 685, 577, 1070, 186953, 33800, 578, 32011, 235265, 714, 1500, 4956, 9523, 148477, 578, 2792, 3757, 20315, 18478, 235269, 3359, 7354, 6757, 576, 476, 44000, 235265, 714, 3448, 603, 235292, 714, 8182, 15034, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
Error decoding dataset: 0
Preprocessing dataset with context: mixed_context
Using prompt column: mixed_prompt
First 5 entries of df[mixed_prompt]:
0    <bos>Who was named president of Disney-ABC tel...
1    <bos>Which pope dies at his home in the Vatica...
2    <bos>Who announces he will retire from Formula...
3    <bos>Which agreement came into effect between ...
4    <bos>Which "country legend" singer died in Ame...
Name: mixed_prompt, dtype: object
Map:   0%|          | 0/75 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 75/75 [00:00<00:00, 8554.92 examples/s]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ü§ó Transformers. Use `eval_strategy` instead
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a tokenizer with `padding_side` not equal to `right` to the SFTTrainer. This might lead to some unexpected behaviour due to overflow issues when training a model in half-precision. You might consider adding `tokenizer.padding_side = 'right'` to your code.
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Dataset after tokenization:
{'i': 68, 'idx': 'TQ_exp_122', 'question': 'In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"?', 'answer': 'Frank Gorshin', 'relevant_context': 'Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in May 2005. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.', 'source': 'TQ_explicet_explicet', 'type': 'dev', 'random_context': 'The Super Bowl hosted in San Diego in 2003 was actually Super Bowl XXXVII (37), not Super Bowl XXXVIII (38). Super Bowl XXXVII was played on January 26, 2003, at Qualcomm Stadium (now known as SDCCU Stadium), where the Tampa Bay Buccaneers defeated the Oakland Raiders with a score of 48-21.', 'wrong_date_context': 'Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in October 1958. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.', 'no_prompt': '<bos>In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? The answer is: Frank Gorshin<eos>', 'rel_prompt': '<bos>In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in May 2005. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television. The answer is: Frank Gorshin<eos>', 'rand_prompt': '<bos>In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: The Super Bowl hosted in San Diego in 2003 was actually Super Bowl XXXVII (37), not Super Bowl XXXVIII (38). Super Bowl XXXVII was played on January 26, 2003, at Qualcomm Stadium (now known as SDCCU Stadium), where the Tampa Bay Buccaneers defeated the Oakland Raiders with a score of 48-21. The answer is: Frank Gorshin<eos>', 'wd_prompt': '<bos>In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in October 1958. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television. The answer is: Frank Gorshin<eos>', 'mixed_prompt': '<bos>In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? The answer is: Frank Gorshin<eos>', 'input_ids': [2, 886, 2782, 235248, 235284, 235276, 235276, 235308, 235269, 948, 671, 3725, 14250, 7206, 3024, 1064, 729, 3836, 604, 926, 4731, 685, 664, 1175, 17675, 136038, 235281, 575, 15734, 4100, 664, 63719, 27017, 714, 3448, 603, 235292, 7851, 653, 976, 12147, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
Error decoding dataset: 0
Data preprocessed
lora
Trainable: 200015872 | total: 8737696768 | Percentage: 2.2891%
Model prepared for training
Trainer set up
  0%|          | 0/12 [00:00<?, ?it/s]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/bitsandbytes/nn/modules.py:426: UserWarning: Input type into Linear4bit is torch.float16, but bnb_4bit_compute_dtype=torch.float32 (default). This will lead to slow inference or training speed.
  warnings.warn(
  8%|‚ñä         | 1/12 [04:36<50:43, 276.70s/it] 17%|‚ñà‚ñã        | 2/12 [08:52<44:06, 264.65s/it] 25%|‚ñà‚ñà‚ñå       | 3/12 [13:22<40:04, 267.13s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 4/12 [17:50<35:39, 267.43s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 5/12 [22:35<31:55, 273.62s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 6/12 [26:54<26:52, 268.73s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 7/12 [31:16<22:13, 266.61s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 8/12 [35:34<17:34, 263.68s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 9/12 [40:06<13:18, 266.29s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 10/12 [44:19<08:44, 262.24s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 11/12 [48:44<04:23, 263.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [53:08<00:00, 263.44s/it]                                                100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [53:08<00:00, 263.44s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [53:08<00:00, 265.74s/it]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'train_runtime': 3191.7241, 'train_samples_per_second': 0.658, 'train_steps_per_second': 0.004, 'train_loss': 2.1737095514933267, 'epoch': 4.36}
Model and tokenizer saved at ./training/models/TQE/gemma-7b/mixed_context
wandb: - 763.069 MB of 763.069 MB uploadedwandb: \ 763.069 MB of 763.093 MB uploadedwandb: | 763.107 MB of 763.107 MB uploadedwandb: 
wandb: Run history:
wandb:       train/epoch ‚ñÅ
wandb: train/global_step ‚ñÅ
wandb: 
wandb: Run summary:
wandb:               total_flos 1.3590556181938176e+16
wandb:              train/epoch 4.36364
wandb:        train/global_step 12
wandb:               train_loss 2.17371
wandb:            train_runtime 3191.7241
wandb: train_samples_per_second 0.658
wandb:   train_steps_per_second 0.004
wandb: 
wandb: üöÄ View run charmed-glade-206 at: https://wandb.ai/danschumac1-nlp/temporal_understanding/runs/bjzqy0j2/workspace
wandb: Synced 6 W&B file(s), 0 media file(s), 4 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240603_165219-bjzqy0j2/logs
