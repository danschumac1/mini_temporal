


AQA: TRAINING gemma-1.1-2b-it WITH mixed context!


wandb: Currently logged in as: danschumac1 (danschumac1-nlp). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.5
wandb: Run data is saved locally in /home/dan/mini_temporal/wandb/run-20240603_174552-jf94fdj4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run volcanic-smoke-207
wandb: ‚≠êÔ∏è View project at https://wandb.ai/danschumac1-nlp/temporal_understanding
wandb: üöÄ View run at https://wandb.ai/danschumac1-nlp/temporal_understanding/runs/jf94fdj4/workspace
WANDB
LOG INTO HUGGING FACE
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /home/dan/.cache/huggingface/token
Login successful
load model
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:00<00:00,  1.23it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:00<00:00,  2.49it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:00<00:00,  2.16it/s]
tokenizer
load data
Data loaded
Preprocessing dataset with context: mixed_context
Using prompt column: mixed_prompt
First 5 entries of df[mixed_prompt]:
0    <bos><start_of_turn>user\nIn June 2004,who mad...
1    <bos><start_of_turn>user\nWhat was the name of...
2    <bos><start_of_turn>user\nRussia attacked the ...
3    <bos><start_of_turn>user\nIn July 2003 which L...
4    <bos><start_of_turn>user\nWhere was Spielberg ...
Name: mixed_prompt, dtype: object
Map:   0%|          | 0/350 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 350/350 [00:00<00:00, 11638.47 examples/s]
Dataset after tokenization:
{'i': 331, 'idx': 'TQ_exp_177', 'question': 'What 1991 musical was based on the novel by Frances Hodgson Burnett?', 'answer': 'The Secret Garden', 'relevant_context': 'The Secret Garden is indeed a musical based on the 1911 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1991. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical.', 'source': 'TQ_explicet_explicet', 'type': 'train', 'random_context': 'Felipe Calder√≥n became President of Mexico on December 1, 2006. He served as the President of Mexico from 2006 to 2012, representing the National Action Party (Partido Acci√≥n Nacional, PAN). His presidency was marked by a strong focus on economic reforms and a controversial military-led approach to tackling drug cartels and organized crime, which resulted in an escalation of violence in some regions of the country.', 'wrong_date_context': 'The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical.', 'no_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett?<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'rel_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 1911 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1991. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossom<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'rand_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: Felipe Calder√≥n became President of Mexico on December 1, 2006. He served as the President of Mexico from 2006 to 2012, representing the National Action Party (Partido Acci√≥n Nacional, PAN). His presidency was marked by a strong focus on economic reforms and a controversial military-led approach to tackling drug cartels and organized crime, which resulted in an escalation of violence in some regions of the country.<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'wd_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossom<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'mixed_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossom<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'input_ids': [2, 106, 1645, 108, 1841, 235248, 235274, 235315, 235315, 235274, 13340, 729, 3482, 611, 573, 9705, 731, 24629, 133957, 109141, 235336, 5698, 603, 573, 4807, 235292, 714, 8182, 15034, 603, 10094, 476, 13340, 3482, 611, 573, 235248, 235284, 235276, 235276, 235284, 9705, 576, 573, 1809, 1503, 731, 24629, 133957, 109141, 235265, 3279, 476, 2870, 578, 23658, 731, 187669, 27896, 578, 4296, 731, 36201, 17073, 235269, 573, 13340, 131613, 611, 31707, 575, 235248, 235274, 235315, 235324, 235318, 235265, 1165, 13992, 573, 3904, 576, 7473, 155504, 235269, 476, 3486, 4645, 4602, 7565, 578, 9244, 575, 573, 7149, 17960, 235269, 1064, 603, 220577, 731, 476, 102331, 31942, 1185, 1284, 603, 29754, 1658, 2187, 235265, 2475, 603, 3841, 3024, 774, 5339, 577, 48284, 235269, 6879, 235269, 577, 3685, 675, 22631, 7624, 1284, 919, 2447, 2211, 235265, 3636, 1997, 18347, 54018, 107, 108, 106, 2516, 108, 651, 3448, 603, 235292, 714, 8182, 15034, 235265, 107, 108, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
Error decoding dataset: 0
Preprocessing dataset with context: mixed_context
Using prompt column: mixed_prompt
First 5 entries of df[mixed_prompt]:
0    <bos><start_of_turn>user\nWho was named presid...
1    <bos><start_of_turn>user\nWhich pope dies at h...
2    <bos><start_of_turn>user\nWho announces he wil...
3    <bos><start_of_turn>user\nWhich agreement came...
4    <bos><start_of_turn>user\nWhich "country legen...
Name: mixed_prompt, dtype: object
Map:   0%|          | 0/75 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 75/75 [00:00<00:00, 5756.45 examples/s]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ü§ó Transformers. Use `eval_strategy` instead
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ü§ó Transformers. Use `eval_strategy` instead
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a tokenizer with `padding_side` not equal to `right` to the SFTTrainer. This might lead to some unexpected behaviour due to overflow issues when training a model in half-precision. You might consider adding `tokenizer.padding_side = 'right'` to your code.
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Dataset after tokenization:
{'i': 68, 'idx': 'TQ_exp_122', 'question': 'In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"?', 'answer': 'Frank Gorshin', 'relevant_context': 'Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in May 2005. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.', 'source': 'TQ_explicet_explicet', 'type': 'dev', 'random_context': 'The Super Bowl hosted in San Diego in 2003 was actually Super Bowl XXXVII (37), not Super Bowl XXXVIII (38). Super Bowl XXXVII was played on January 26, 2003, at Qualcomm Stadium (now known as SDCCU Stadium), where the Tampa Bay Buccaneers defeated the Oakland Raiders with a score of 48-21.', 'wrong_date_context': 'Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in October 1958. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.', 'no_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"?<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'rel_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in May 2005. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'rand_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: The Super Bowl hosted in San Diego in 2003 was actually Super Bowl XXXVII (37), not Super Bowl XXXVIII (38). Super Bowl XXXVII was played on January 26, 2003, at Qualcomm Stadium (now known as SDCCU Stadium), where the Tampa Bay Buccaneers defeated the Oakland Raiders with a score of 48-21.<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'wd_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in October 1958. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'mixed_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"?<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'input_ids': [2, 106, 1645, 108, 886, 2782, 235248, 235284, 235276, 235276, 235308, 235269, 948, 671, 3725, 14250, 7206, 3024, 1064, 729, 3836, 604, 926, 4731, 685, 664, 1175, 17675, 136038, 235281, 575, 15734, 4100, 664, 63719, 27017, 107, 108, 106, 2516, 108, 651, 3448, 603, 235292, 7851, 653, 976, 12147, 235265, 107, 108, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
Error decoding dataset: 0
Data preprocessed
lora
Model prepared for training
Trainer set up
  0%|          | 0/12 [00:00<?, ?it/s]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/bitsandbytes/nn/modules.py:426: UserWarning: Input type into Linear4bit is torch.float16, but bnb_4bit_compute_dtype=torch.float32 (default). This will lead to slow inference or training speed.
  warnings.warn(
  8%|‚ñä         | 1/12 [00:22<04:06, 22.42s/it] 17%|‚ñà‚ñã        | 2/12 [00:44<03:41, 22.13s/it] 25%|‚ñà‚ñà‚ñå       | 3/12 [01:06<03:17, 21.99s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 4/12 [01:28<02:56, 22.11s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 5/12 [01:50<02:35, 22.15s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 6/12 [02:12<02:11, 21.98s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 7/12 [02:34<01:50, 22.05s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 8/12 [02:56<01:28, 22.00s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 9/12 [03:18<01:06, 22.02s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 10/12 [03:40<00:44, 22.05s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 11/12 [04:02<00:21, 21.88s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [04:24<00:00, 21.93s/it]                                               100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [04:24<00:00, 21.93s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [04:24<00:00, 22.01s/it]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'train_runtime': 264.7321, 'train_samples_per_second': 7.933, 'train_steps_per_second': 0.045, 'train_loss': 4.8441823323567705, 'epoch': 4.36}
THIS IS A TEST
Model and tokenizer saved at ./training/models/TQE/gemma-1_1-2b-it/mixed_context
wandb: - 74.863 MB of 74.863 MB uploadedwandb: \ 74.863 MB of 74.863 MB uploadedwandb: | 74.897 MB of 74.935 MB uploaded (0.003 MB deduped)wandb: / 74.935 MB of 74.935 MB uploaded (0.003 MB deduped)wandb: 
wandb: Run history:
wandb:       train/epoch ‚ñÅ
wandb: train/global_step ‚ñÅ
wandb: 
wandb: Run summary:
wandb:               total_flos 3003060706394112.0
wandb:              train/epoch 4.36364
wandb:        train/global_step 12
wandb:               train_loss 4.84418
wandb:            train_runtime 264.7321
wandb: train_samples_per_second 7.933
wandb:   train_steps_per_second 0.045
wandb: 
wandb: üöÄ View run volcanic-smoke-207 at: https://wandb.ai/danschumac1-nlp/temporal_understanding/runs/jf94fdj4/workspace
wandb: Synced 6 W&B file(s), 0 media file(s), 6 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240603_174552-jf94fdj4/logs


AQA: TRAINING gemma-1.1-7b-it WITH mixed context!


wandb: Currently logged in as: danschumac1 (danschumac1-nlp). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.5
wandb: Run data is saved locally in /home/dan/mini_temporal/wandb/run-20240603_175040-w4648itn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deep-glitter-208
wandb: ‚≠êÔ∏è View project at https://wandb.ai/danschumac1-nlp/temporal_understanding
wandb: üöÄ View run at https://wandb.ai/danschumac1-nlp/temporal_understanding/runs/w4648itn/workspace
WANDB
LOG INTO HUGGING FACE
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /home/dan/.cache/huggingface/token
Login successful
load model
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:00<00:02,  1.31it/s]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:01<00:01,  1.30it/s]Loading checkpoint shards:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:02<00:00,  1.31it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:02<00:00,  1.63it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:02<00:00,  1.49it/s]
tokenizer
load data
Data loaded
Preprocessing dataset with context: mixed_context
Using prompt column: mixed_prompt
First 5 entries of df[mixed_prompt]:
0    <bos><start_of_turn>user\nIn June 2004,who mad...
1    <bos><start_of_turn>user\nWhat was the name of...
2    <bos><start_of_turn>user\nRussia attacked the ...
3    <bos><start_of_turn>user\nIn July 2003 which L...
4    <bos><start_of_turn>user\nWhere was Spielberg ...
Name: mixed_prompt, dtype: object
Map:   0%|          | 0/350 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 350/350 [00:00<00:00, 9565.12 examples/s]
Dataset after tokenization:
{'i': 331, 'idx': 'TQ_exp_177', 'question': 'What 1991 musical was based on the novel by Frances Hodgson Burnett?', 'answer': 'The Secret Garden', 'relevant_context': 'The Secret Garden is indeed a musical based on the 1911 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1991. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical.', 'source': 'TQ_explicet_explicet', 'type': 'train', 'random_context': 'Felipe Calder√≥n became President of Mexico on December 1, 2006. He served as the President of Mexico from 2006 to 2012, representing the National Action Party (Partido Acci√≥n Nacional, PAN). His presidency was marked by a strong focus on economic reforms and a controversial military-led approach to tackling drug cartels and organized crime, which resulted in an escalation of violence in some regions of the country.', 'wrong_date_context': 'The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical.', 'no_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett?<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'rel_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 1911 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1991. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossom<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'rand_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: Felipe Calder√≥n became President of Mexico on December 1, 2006. He served as the President of Mexico from 2006 to 2012, representing the National Action Party (Partido Acci√≥n Nacional, PAN). His presidency was marked by a strong focus on economic reforms and a controversial military-led approach to tackling drug cartels and organized crime, which resulted in an escalation of violence in some regions of the country.<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'wd_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossom<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'mixed_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossom<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'input_ids': [2, 106, 1645, 108, 1841, 235248, 235274, 235315, 235315, 235274, 13340, 729, 3482, 611, 573, 9705, 731, 24629, 133957, 109141, 235336, 5698, 603, 573, 4807, 235292, 714, 8182, 15034, 603, 10094, 476, 13340, 3482, 611, 573, 235248, 235284, 235276, 235276, 235284, 9705, 576, 573, 1809, 1503, 731, 24629, 133957, 109141, 235265, 3279, 476, 2870, 578, 23658, 731, 187669, 27896, 578, 4296, 731, 36201, 17073, 235269, 573, 13340, 131613, 611, 31707, 575, 235248, 235274, 235315, 235324, 235318, 235265, 1165, 13992, 573, 3904, 576, 7473, 155504, 235269, 476, 3486, 4645, 4602, 7565, 578, 9244, 575, 573, 7149, 17960, 235269, 1064, 603, 220577, 731, 476, 102331, 31942, 1185, 1284, 603, 29754, 1658, 2187, 235265, 2475, 603, 3841, 3024, 774, 5339, 577, 48284, 235269, 6879, 235269, 577, 3685, 675, 22631, 7624, 1284, 919, 2447, 2211, 235265, 3636, 1997, 18347, 54018, 107, 108, 106, 2516, 108, 651, 3448, 603, 235292, 714, 8182, 15034, 235265, 107, 108, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
Error decoding dataset: 0
Preprocessing dataset with context: mixed_context
Using prompt column: mixed_prompt
First 5 entries of df[mixed_prompt]:
0    <bos><start_of_turn>user\nWho was named presid...
1    <bos><start_of_turn>user\nWhich pope dies at h...
2    <bos><start_of_turn>user\nWho announces he wil...
3    <bos><start_of_turn>user\nWhich agreement came...
4    <bos><start_of_turn>user\nWhich "country legen...
Name: mixed_prompt, dtype: object
Map:   0%|          | 0/75 [00:00<?, ? examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 75/75 [00:00<00:00, 6032.89 examples/s]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ü§ó Transformers. Use `eval_strategy` instead
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ü§ó Transformers. Use `eval_strategy` instead
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a tokenizer with `padding_side` not equal to `right` to the SFTTrainer. This might lead to some unexpected behaviour due to overflow issues when training a model in half-precision. You might consider adding `tokenizer.padding_side = 'right'` to your code.
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Dataset after tokenization:
{'i': 68, 'idx': 'TQ_exp_122', 'question': 'In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"?', 'answer': 'Frank Gorshin', 'relevant_context': 'Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in May 2005. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.', 'source': 'TQ_explicet_explicet', 'type': 'dev', 'random_context': 'The Super Bowl hosted in San Diego in 2003 was actually Super Bowl XXXVII (37), not Super Bowl XXXVIII (38). Super Bowl XXXVII was played on January 26, 2003, at Qualcomm Stadium (now known as SDCCU Stadium), where the Tampa Bay Buccaneers defeated the Oakland Raiders with a score of 48-21.', 'wrong_date_context': 'Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in October 1958. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.', 'no_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"?<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'rel_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in May 2005. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'rand_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: The Super Bowl hosted in San Diego in 2003 was actually Super Bowl XXXVII (37), not Super Bowl XXXVIII (38). Super Bowl XXXVII was played on January 26, 2003, at Qualcomm Stadium (now known as SDCCU Stadium), where the Tampa Bay Buccaneers defeated the Oakland Raiders with a score of 48-21.<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'wd_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in October 1958. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'mixed_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"?<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'input_ids': [2, 106, 1645, 108, 886, 2782, 235248, 235284, 235276, 235276, 235308, 235269, 948, 671, 3725, 14250, 7206, 3024, 1064, 729, 3836, 604, 926, 4731, 685, 664, 1175, 17675, 136038, 235281, 575, 15734, 4100, 664, 63719, 27017, 107, 108, 106, 2516, 108, 651, 3448, 603, 235292, 7851, 653, 976, 12147, 235265, 107, 108, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
Error decoding dataset: 0
Data preprocessed
lora
Model prepared for training
Trainer set up
  0%|          | 0/12 [00:00<?, ?it/s]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/bitsandbytes/nn/modules.py:426: UserWarning: Input type into Linear4bit is torch.float16, but bnb_4bit_compute_dtype=torch.float32 (default). This will lead to slow inference or training speed.
  warnings.warn(
  8%|‚ñä         | 1/12 [01:07<12:27, 67.93s/it] 17%|‚ñà‚ñã        | 2/12 [02:15<11:15, 67.55s/it] 25%|‚ñà‚ñà‚ñå       | 3/12 [03:22<10:06, 67.40s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 4/12 [04:30<09:02, 67.76s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 5/12 [05:38<07:54, 67.77s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 6/12 [06:44<06:43, 67.30s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 7/12 [07:52<05:36, 67.39s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 8/12 [08:59<04:29, 67.36s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 9/12 [10:07<03:22, 67.36s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 10/12 [11:14<02:14, 67.36s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 11/12 [12:20<01:06, 66.88s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [13:27<00:00, 67.06s/it]                                               100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [13:27<00:00, 67.06s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [13:27<00:00, 67.32s/it]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'train_runtime': 808.689, 'train_samples_per_second': 2.597, 'train_steps_per_second': 0.015, 'train_loss': 9.940240224202475, 'epoch': 4.36}
THIS IS A TEST
Model and tokenizer saved at ./training/models/TQE/gemma-1_1-7b-it/mixed_context
wandb: - 190.819 MB of 190.819 MB uploadedwandb: \ 190.857 MB of 190.857 MB uploadedwandb: 
wandb: Run history:
wandb:       train/epoch ‚ñÅ
wandb: train/global_step ‚ñÅ
wandb: 
wandb: Run summary:
wandb:               total_flos 1.1705062207168512e+16
wandb:              train/epoch 4.36364
wandb:        train/global_step 12
wandb:               train_loss 9.94024
wandb:            train_runtime 808.689
wandb: train_samples_per_second 2.597
wandb:   train_steps_per_second 0.015
wandb: 
wandb: üöÄ View run deep-glitter-208 at: https://wandb.ai/danschumac1-nlp/temporal_understanding/runs/w4648itn/workspace
wandb: Synced 6 W&B file(s), 0 media file(s), 4 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240603_175040-w4648itn/logs
