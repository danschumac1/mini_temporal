LOG INTO HUGGING FACE
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /home/dan/.cache/huggingface/token
Login successful
load model
Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.44it/s]
tokenizer
load data
Data loaded
<bos><start_of_turn>user
In June 2004,who made its first increase in interest rates in nearly four years?<end_of_turn>
<start_of_turn>model
The answer is: The Federal Reserve.<end_of_turn>
<eos>
<class 'str'>
<bos><start_of_turn>user
Who was named president of Disney-ABC television group in 2004?<end_of_turn>
<start_of_turn>model
The answer is: Anne Sweeney.<end_of_turn>
<eos>
<class 'str'>
Data preprocessed
lora
Trainable: 78446592 | total: 2584619008 | Percentage: 3.0351%
Model prepared for training
Trainer set up
Map: 100%|██████████| 350/350 [00:00<00:00, 8909.21 examples/s]
Map: 100%|██████████| 75/75 [00:00<00:00, 7714.28 examples/s]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a tokenizer with `padding_side` not equal to `right` to the SFTTrainer. This might lead to some unexpected behaviour due to overflow issues when training a model in half-precision. You might consider adding `tokenizer.padding_side = 'right'` to your code.
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/bitsandbytes/nn/modules.py:426: UserWarning: Input type into Linear4bit is torch.float16, but bnb_4bit_compute_dtype=torch.float32 (default). This will lead to slow inference or training speed.
  warnings.warn(
{'loss': 4.8834, 'grad_norm': 6.26649808883667, 'learning_rate': 1.6750418760469013e-05, 'epoch': 0.73}
 17%|█▋        | 1/6 [02:55<14:38, 175.61s/it]

 33%|███▎      | 2/6 [06:21<12:54, 193.53s/it]

 50%|█████     | 3/6 [09:33<09:37, 192.55s/it]


 83%|████████▎ | 5/6 [15:42<03:07, 187.83s/it]

100%|██████████| 6/6 [19:02<00:00, 190.49s/it]
{'loss': 4.2715, 'grad_norm': 4.702542781829834, 'learning_rate': 0.0, 'epoch': 4.36}
{'train_runtime': 1144.2406, 'train_samples_per_second': 1.835, 'train_steps_per_second': 0.005, 'train_loss': 4.604453245798747, 'epoch': 4.36}
Model and tokenizer saved at ./training/models/TQE/gemma-1_1-2b-it/random_context
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(