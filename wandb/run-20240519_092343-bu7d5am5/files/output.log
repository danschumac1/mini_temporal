LOG INTO HUGGING FACE
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /home/dan/.cache/huggingface/token
Login successful
`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.26s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.44it/s]
/home/dan/mini_temporal/training/fine_tune_gemma_rios.py:144: FutureWarning: Passing literal json to 'read_json' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.
  return pd.read_json('\n'.join(lines), lines=True)
/home/dan/mini_temporal/training/fine_tune_gemma_rios.py:144: FutureWarning: Passing literal json to 'read_json' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.
  return pd.read_json('\n'.join(lines), lines=True)
Map: 100%|██████████| 350/350 [00:00<00:00, 14871.16 examples/s]
Map: 100%|██████████| 75/75 [00:00<00:00, 12112.93 examples/s]
Trainable: 78446592 | total: 2584619008 | Percentage: 3.0351%
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a tokenizer with `padding_side` not equal to `right` to the SFTTrainer. This might lead to some unexpected behaviour due to overflow issues when training a model in half-precision. You might consider adding `tokenizer.padding_side = 'right'` to your code.
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/bitsandbytes/nn/modules.py:426: UserWarning: Input type into Linear4bit is torch.float16, but bnb_4bit_compute_dtype=torch.float32 (default). This will lead to slow inference or training speed.
  warnings.warn(
{'loss': 4.9415, 'grad_norm': 6.596208095550537, 'learning_rate': 1.6750418760469013e-05, 'epoch': 0.73}
 17%|█▋        | 1/6 [00:49<04:08, 49.67s/it]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'loss': 4.8824, 'grad_norm': 6.495243549346924, 'learning_rate': 1.3400335008375211e-05, 'epoch': 1.45}
 33%|███▎      | 2/6 [01:41<03:23, 50.92s/it]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'loss': 4.8684, 'grad_norm': 6.707803726196289, 'learning_rate': 1.005025125628141e-05, 'epoch': 2.18}

 67%|██████▋   | 4/6 [03:22<01:40, 50.46s/it]
 67%|██████▋   | 4/6 [03:22<01:40, 50.46s/it]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'loss': 4.7177, 'grad_norm': 6.879639148712158, 'learning_rate': 3.350083752093803e-06, 'epoch': 3.64}
 83%|████████▎ | 5/6 [04:12<00:50, 50.45s/it]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'loss': 4.6579, 'grad_norm': 6.782829761505127, 'learning_rate': 0.0, 'epoch': 4.36}
{'train_runtime': 305.2363, 'train_samples_per_second': 6.88, 'train_steps_per_second': 0.02, 'train_loss': 4.807780424753825, 'epoch': 4.36}
Model and tokenizer saved at ./training/models/gemma-2b/no_context
100%|██████████| 6/6 [05:02<00:00, 50.41s/it]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
100%|██████████| 6/6 [05:03<00:00, 50.66s/it]