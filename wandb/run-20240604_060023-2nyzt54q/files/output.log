LOG INTO HUGGING FACE
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /home/dan/.cache/huggingface/token
Login successful
load model
`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.

Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:02<00:02,  1.18s/it]
tokenizer

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:04<00:00,  1.02s/it]
Data loaded
Map:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 28000/60000 [00:01<00:01, 21606.79 examples/s]
Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 60000
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60000/60000 [00:02<00:00, 20653.69 examples/s]
Map:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 4000/7500 [00:00<00:00, 22815.31 examples/s]
Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 7500
})
Data preprocessed
lora
Trainable: 200015872 | total: 8737696768 | Percentage: 2.2891%
Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7500/7500 [00:00<00:00, 22770.48 examples/s]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Trainer set up
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a tokenizer with `padding_side` not equal to `right` to the SFTTrainer. This might lead to some unexpected behaviour due to overflow issues when training a model in half-precision. You might consider adding `tokenizer.padding_side = 'right'` to your code.
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
  0%|          | 0/468 [00:00<?, ?it/s]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/bitsandbytes/nn/modules.py:426: UserWarning: Input type into Linear4bit is torch.float16, but bnb_4bit_compute_dtype=torch.float32 (default). This will lead to slow inference or training speed.
  warnings.warn(























  5%|â–Œ         | 24/468 [25:21<7:47:42, 63.20s/it]

























 10%|â–ˆ         | 49/468 [51:54<7:21:45, 63.26s/it]


























 16%|â–ˆâ–Œ        | 75/468 [1:19:17<6:52:44, 63.01s/it]
























 21%|â–ˆâ–ˆ        | 99/468 [1:44:43<6:30:55, 63.57s/it]


























 27%|â–ˆâ–ˆâ–‹       | 125/468 [2:12:22<6:04:10, 63.71s/it]

























 32%|â–ˆâ–ˆâ–ˆâ–      | 150/468 [2:38:47<5:34:45, 63.16s/it]

























 37%|â–ˆâ–ˆâ–ˆâ–‹      | 175/468 [3:05:21<5:07:07, 62.89s/it]

























 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 200/468 [3:31:39<4:44:21, 63.66s/it]
























 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 224/468 [3:56:57<4:18:01, 63.45s/it]


























 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 250/468 [4:24:47<3:54:31, 64.55s/it]

























 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 275/468 [4:52:03<3:29:05, 65.00s/it]

























 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 300/468 [5:18:53<2:57:04, 63.24s/it]

























 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 325/468 [5:45:25<2:32:49, 64.12s/it]

























 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 350/468 [6:12:01<2:03:30, 62.80s/it]

























 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 375/468 [6:38:54<1:38:58, 63.85s/it]

























 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 400/468 [7:05:33<1:13:16, 64.65s/it]

























 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 425/468 [7:32:24<46:23, 64.72s/it]

























 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 450/468 [7:59:27<19:35, 65.30s/it]

















100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 467/468 [8:17:38<01:04, 64.32s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 468/468 [8:18:45<00:00, 63.94s/it]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Model and tokenizer saved at ./training/models/AQA/gemma-7b/wrong_date_context