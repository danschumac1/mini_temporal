LOG INTO HUGGING FACE
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /home/dan/.cache/huggingface/token
Login successful
load model
`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.40s/it]
tokenizer
load data
Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.31it/s]

Map:  67%|██████▋   | 40000/60000 [00:02<00:00, 20819.74 examples/s]
Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 60000
})
Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 7500
})
Data preprocessed
Map: 100%|██████████| 60000/60000 [00:02<00:00, 20661.40 examples/s]
Map: 100%|██████████| 7500/7500 [00:00<00:00, 17239.87 examples/s]
Trainable: 78446592 | total: 2584619008 | Percentage: 3.0351%
Model prepared for training
Trainer set up
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a tokenizer with `padding_side` not equal to `right` to the SFTTrainer. This might lead to some unexpected behaviour due to overflow issues when training a model in half-precision. You might consider adding `tokenizer.padding_side = 'right'` to your code.
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
  0%|          | 0/468 [00:00<?, ?it/s]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/bitsandbytes/nn/modules.py:426: UserWarning: Input type into Linear4bit is torch.float16, but bnb_4bit_compute_dtype=torch.float32 (default). This will lead to slow inference or training speed.
  warnings.warn(























  5%|▌         | 24/468 [08:12<2:31:51, 20.52s/it]


























 11%|█         | 50/468 [17:09<2:20:18, 20.14s/it]
























 16%|█▌        | 74/468 [25:21<2:15:44, 20.67s/it]

























 21%|██        | 99/468 [33:52<2:06:15, 20.53s/it]

























 26%|██▋       | 124/468 [42:26<1:58:46, 20.72s/it]

























 32%|███▏      | 149/468 [50:59<1:49:47, 20.65s/it]

























 37%|███▋      | 174/468 [59:37<1:40:51, 20.58s/it]

























 43%|████▎     | 199/468 [1:08:10<1:33:11, 20.79s/it]


























 48%|████▊     | 225/468 [1:17:04<1:24:04, 20.76s/it]
























 53%|█████▎    | 249/468 [1:25:23<1:15:58, 20.82s/it]

























 59%|█████▊    | 274/468 [1:34:09<1:08:43, 21.26s/it]

























 64%|██████▍   | 299/468 [1:42:47<58:03, 20.61s/it]

























 69%|██████▉   | 324/468 [1:51:19<49:06, 20.46s/it]

























 75%|███████▍  | 349/468 [1:59:54<40:31, 20.44s/it]

























 80%|███████▉  | 374/468 [2:08:32<32:16, 20.60s/it]

























 85%|████████▌ | 399/468 [2:17:07<24:12, 21.06s/it]

























 91%|█████████ | 424/468 [2:25:44<15:02, 20.52s/it]

























 96%|█████████▌| 449/468 [2:34:25<06:34, 20.76s/it]


















100%|█████████▉| 467/468 [2:40:40<00:20, 20.87s/it]
{'train_runtime': 9662.9452, 'train_samples_per_second': 6.209, 'train_steps_per_second': 0.048, 'train_loss': 1.1745975975297456, 'epoch': 1.0}
100%|██████████| 468/468 [2:41:01<00:00, 20.64s/it]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(