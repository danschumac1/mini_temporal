LOG INTO HUGGING FACE
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /home/dan/.cache/huggingface/token
Login successful
load model



Loading checkpoint shards: 100%|██████████| 4/4 [00:07<00:00,  1.87s/it]
tokenizer
load data
Data loaded
Map:   0%|          | 0/350 [00:00<?, ? examples/s]
<bos><start_of_turn>user
In June 2004,who made its first increase in interest rates in nearly four years?<end_of_turn>
<start_of_turn>model
The answer is: The Federal Reserve.<end_of_turn>
<eos>
<class 'str'>
<bos><start_of_turn>user
Who was named president of Disney-ABC television group in 2004?<end_of_turn>
<start_of_turn>model
The answer is: Anne Sweeney.<end_of_turn>
<eos>
<class 'str'>
Data preprocessed
Map: 100%|██████████| 350/350 [00:00<00:00, 9011.15 examples/s]
Map: 100%|██████████| 75/75 [00:00<00:00, 7571.13 examples/s]
Trainable: 200015872 | total: 8737696768 | Percentage: 2.2891%
Model prepared for training
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a tokenizer with `padding_side` not equal to `right` to the SFTTrainer. This might lead to some unexpected behaviour due to overflow issues when training a model in half-precision. You might consider adding `tokenizer.padding_side = 'right'` to your code.
  warnings.warn(
Trainer set up
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'loss': 9.0082, 'grad_norm': 8.466141700744629, 'learning_rate': 1.8379281537176274e-05, 'epoch': 0.36}
  0%|          | 0/12 [00:00<?, ?it/s]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/bitsandbytes/nn/modules.py:426: UserWarning: Input type into Linear4bit is torch.float16, but bnb_4bit_compute_dtype=torch.float32 (default). This will lead to slow inference or training speed.
  warnings.warn(

 17%|█▋        | 2/12 [11:37<58:02, 348.23s/it]

 25%|██▌       | 3/12 [17:26<52:19, 348.88s/it]
{'loss': 8.2147, 'grad_norm': 7.635562896728516, 'learning_rate': 1.5037593984962406e-05, 'epoch': 1.09}

 33%|███▎      | 4/12 [23:29<47:15, 354.44s/it]

 42%|████▏     | 5/12 [29:00<40:20, 345.84s/it]

 50%|█████     | 6/12 [34:41<34:26, 344.34s/it]


 67%|██████▋   | 8/12 [46:11<22:49, 342.41s/it]
{'loss': 7.3844, 'grad_norm': 8.618781089782715, 'learning_rate': 6.683375104427736e-06, 'epoch': 2.91}


 83%|████████▎ | 10/12 [57:43<11:29, 344.90s/it]
{'loss': 6.9061, 'grad_norm': 8.681435585021973, 'learning_rate': 3.341687552213868e-06, 'epoch': 3.64}

 92%|█████████▏| 11/12 [1:03:19<05:42, 342.10s/it]
{'loss': 6.6883, 'grad_norm': 8.704157829284668, 'learning_rate': 0.0, 'epoch': 4.36}
{'train_runtime': 4126.973, 'train_samples_per_second': 0.509, 'train_steps_per_second': 0.003, 'train_loss': 7.645813544591268, 'epoch': 4.36}
100%|██████████| 12/12 [1:08:44<00:00, 343.69s/it]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(