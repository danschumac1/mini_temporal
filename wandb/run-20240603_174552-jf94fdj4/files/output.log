LOG INTO HUGGING FACE
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /home/dan/.cache/huggingface/token
Login successful
load model
tokenizer
Loading checkpoint shards: 100%|| 2/2 [00:00<00:00,  2.16it/s]
load data
Data loaded
Preprocessing dataset with context: mixed_context
Using prompt column: mixed_prompt
First 5 entries of df[mixed_prompt]:
0    <bos><start_of_turn>user\nIn June 2004,who mad...
1    <bos><start_of_turn>user\nWhat was the name of...
2    <bos><start_of_turn>user\nRussia attacked the ...
3    <bos><start_of_turn>user\nIn July 2003 which L...
4    <bos><start_of_turn>user\nWhere was Spielberg ...
Name: mixed_prompt, dtype: object
Dataset after tokenization:
{'i': 331, 'idx': 'TQ_exp_177', 'question': 'What 1991 musical was based on the novel by Frances Hodgson Burnett?', 'answer': 'The Secret Garden', 'relevant_context': 'The Secret Garden is indeed a musical based on the 1911 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1991. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical.', 'source': 'TQ_explicet_explicet', 'type': 'train', 'random_context': 'Felipe Calder贸n became President of Mexico on December 1, 2006. He served as the President of Mexico from 2006 to 2012, representing the National Action Party (Partido Acci贸n Nacional, PAN). His presidency was marked by a strong focus on economic reforms and a controversial military-led approach to tackling drug cartels and organized crime, which resulted in an escalation of violence in some regions of the country.', 'wrong_date_context': 'The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossoms as she brings new life to a neglected garden, as well as to her sickly cousin and uncle. The show received critical acclaim and won several Tony Awards, including Best Book of a Musical.', 'no_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett?<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'rel_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 1911 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1991. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossom<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'rand_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: Felipe Calder贸n became President of Mexico on December 1, 2006. He served as the President of Mexico from 2006 to 2012, representing the National Action Party (Partido Acci贸n Nacional, PAN). His presidency was marked by a strong focus on economic reforms and a controversial military-led approach to tackling drug cartels and organized crime, which resulted in an escalation of violence in some regions of the country.<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'wd_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossom<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'mixed_prompt': '<bos><start_of_turn>user\nWhat 1991 musical was based on the novel by Frances Hodgson Burnett? Here is the context: The Secret Garden is indeed a musical based on the 2002 novel of the same name by Frances Hodgson Burnett. With a book and lyrics by Marsha Norman and music by Lucy Simon, the musical premiered on Broadway in 1976. It tells the story of Mary Lennox, a young English girl born and raised in the British Raj, who is orphaned by a cholera outbreak when she is eleven years old. She is sent away from India to Yorkshire, England, to live with relatives whom she has never met. Her own personality blossom<end_of_turn>\n<start_of_turn>model\nThe answer is: The Secret Garden.<end_of_turn>\n<eos>', 'input_ids': [2, 106, 1645, 108, 1841, 235248, 235274, 235315, 235315, 235274, 13340, 729, 3482, 611, 573, 9705, 731, 24629, 133957, 109141, 235336, 5698, 603, 573, 4807, 235292, 714, 8182, 15034, 603, 10094, 476, 13340, 3482, 611, 573, 235248, 235284, 235276, 235276, 235284, 9705, 576, 573, 1809, 1503, 731, 24629, 133957, 109141, 235265, 3279, 476, 2870, 578, 23658, 731, 187669, 27896, 578, 4296, 731, 36201, 17073, 235269, 573, 13340, 131613, 611, 31707, 575, 235248, 235274, 235315, 235324, 235318, 235265, 1165, 13992, 573, 3904, 576, 7473, 155504, 235269, 476, 3486, 4645, 4602, 7565, 578, 9244, 575, 573, 7149, 17960, 235269, 1064, 603, 220577, 731, 476, 102331, 31942, 1185, 1284, 603, 29754, 1658, 2187, 235265, 2475, 603, 3841, 3024, 774, 5339, 577, 48284, 235269, 6879, 235269, 577, 3685, 675, 22631, 7624, 1284, 919, 2447, 2211, 235265, 3636, 1997, 18347, 54018, 107, 108, 106, 2516, 108, 651, 3448, 603, 235292, 714, 8182, 15034, 235265, 107, 108, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
Error decoding dataset: 0
Preprocessing dataset with context: mixed_context
Using prompt column: mixed_prompt
First 5 entries of df[mixed_prompt]:
0    <bos><start_of_turn>user\nWho was named presid...
1    <bos><start_of_turn>user\nWhich pope dies at h...
2    <bos><start_of_turn>user\nWho announces he wil...
3    <bos><start_of_turn>user\nWhich agreement came...
4    <bos><start_of_turn>user\nWhich "country legen...
Name: mixed_prompt, dtype: object
Map: 100%|| 350/350 [00:00<00:00, 11638.47 examples/s]
Map: 100%|| 75/75 [00:00<00:00, 5756.45 examples/s]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of  Transformers. Use `eval_strategy` instead
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of  Transformers. Use `eval_strategy` instead
  warnings.warn(
Dataset after tokenization:
{'i': 68, 'idx': 'TQ_exp_122', 'question': 'In May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"?', 'answer': 'Frank Gorshin', 'relevant_context': 'Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in May 2005. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.', 'source': 'TQ_explicet_explicet', 'type': 'dev', 'random_context': 'The Super Bowl hosted in San Diego in 2003 was actually Super Bowl XXXVII (37), not Super Bowl XXXVIII (38). Super Bowl XXXVII was played on January 26, 2003, at Qualcomm Stadium (now known as SDCCU Stadium), where the Tampa Bay Buccaneers defeated the Oakland Raiders with a score of 48-21.', 'wrong_date_context': 'Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in October 1958. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.', 'no_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"?<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'rel_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in May 2005. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'rand_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: The Super Bowl hosted in San Diego in 2003 was actually Super Bowl XXXVII (37), not Super Bowl XXXVIII (38). Super Bowl XXXVII was played on January 26, 2003, at Qualcomm Stadium (now known as SDCCU Stadium), where the Tampa Bay Buccaneers defeated the Oakland Raiders with a score of 48-21.<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'wd_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"? Here is the context: Frank Gorshin, the American actor and comedian known for his portrayal of "the Riddler" in the 1960s television series "Batman," passed away in October 1958. Gorshin\'s performance as the Riddler, with his maniacal laugh and array of riddles and puzzles, made him one of the show\'s most memorable villains, earning him an Emmy nomination. Beyond his role in "Batman," Gorshin had a diverse career in both film and television.<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'mixed_prompt': '<bos><start_of_turn>user\nIn May 2005, which an American actor passed away who was known for his role as "the Riddler" in television series "Batman"?<end_of_turn>\n<start_of_turn>model\nThe answer is: Frank Gorshin.<end_of_turn>\n<eos>', 'input_ids': [2, 106, 1645, 108, 886, 2782, 235248, 235284, 235276, 235276, 235308, 235269, 948, 671, 3725, 14250, 7206, 3024, 1064, 729, 3836, 604, 926, 4731, 685, 664, 1175, 17675, 136038, 235281, 575, 15734, 4100, 664, 63719, 27017, 107, 108, 106, 2516, 108, 651, 3448, 603, 235292, 7851, 653, 976, 12147, 235265, 107, 108, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
Error decoding dataset: 0
Data preprocessed
lora
Model prepared for training
Trainer set up
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a tokenizer with `padding_side` not equal to `right` to the SFTTrainer. This might lead to some unexpected behaviour due to overflow issues when training a model in half-precision. You might consider adding `tokenizer.padding_side = 'right'` to your code.
  warnings.warn(
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
  0%|          | 0/12 [00:00<?, ?it/s]/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/bitsandbytes/nn/modules.py:426: UserWarning: Input type into Linear4bit is torch.float16, but bnb_4bit_compute_dtype=torch.float32 (default). This will lead to slow inference or training speed.
  warnings.warn(










 92%|| 11/12 [04:02<00:21, 21.88s/it]
{'train_runtime': 264.7321, 'train_samples_per_second': 7.933, 'train_steps_per_second': 0.045, 'train_loss': 4.8441823323567705, 'epoch': 4.36}
100%|| 12/12 [04:24<00:00, 22.01s/it]
/home/dan/miniconda3/envs/danEnv/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Model and tokenizer saved at ./training/models/TQE/gemma-1_1-2b-it/mixed_context